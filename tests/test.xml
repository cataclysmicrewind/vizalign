<project name="VizAlign Test Project" basedir="." default="tests">
	<!-- setup a prefix for all environment variables -->
	<property environment="env" />
	
	<!-- Setup paths for build -->
	<property name="src.loc" location="${basedir}/../src" />
	<property name="libs.loc" location="${basedir}/../lib" />
	<property name="output.loc" location="${basedir}/tests/testresults/" />
	<property name="flexunit.loc" location="${libs.loc}/flexunit/4.0" />
	
	
	
	
	<!-- Setup Flex and FlexUnit ant tasks -->
	<!-- You can set this directly so mxmlc will work correctly, or set FLEX_HOME as an environment variable and use as below -->
	<property name="FLEX_HOME" location="${env.FLEX_HOME}" />
	
	<taskdef resource="flexTasks.tasks" classpath="${FLEX_HOME}/ant/lib/flexTasks.jar" />
	 <taskdef resource="flexUnitTasks.tasks">
	   <classpath>
	      <fileset dir="${flexunit.loc}">
	         <include name="flexUnitTasks*.jar" />
	      </fileset>
	   </classpath>
	</taskdef>
	

	
	
	
	
	
	
	<!-- 
			*** CLEAN ***
			
				Remove all directories created during the build process 
			
			
	-->
	<target name="clean">
		<delete dir="${output.loc}" />
	</target>
	
	
	<!-- 
			*** COMPILE ***
			
				Compiles the swf that ANT will run
			
			
	-->
	<target name="compile">
		<mkdir dir="${output.loc}" />
		<mxmlc file="${basedir}/TestRunner.as" output="${output.loc}/bin/TestRunner.swf">
			<source-path path-element="${src.loc}"/>
			<compiler.library-path dir="${libs.loc}" append="true" >
				<include name="*.swc" />
			</compiler.library-path>
			<compiler.verbose-stacktraces>true</compiler.verbose-stacktraces>
			<compiler.headless-server>true</compiler.headless-server>
			<static-link-runtime-shared-libraries>true</static-link-runtime-shared-libraries>
		</mxmlc>
	</target>
	
	
	
	
	<!-- 
			*** TESTS ***
			
				Run the tests
			
			
	-->
	<target name="tests" depends="compile" >
		<!-- Create directories needed for the build process -->
		<!-- <mkdir dir="${output.loc}" />  -->
		<!-- Compile Main.mxml as a SWF -->

		<!-- Execute FlexUnit tests and publish reports -->
		<flexunit swf="${output.loc}/bin/TestRunner.swf"
		    toDir="${output.loc}" 
			haltonfailure="false" 
			verbose="true" 
			localTrusted="true" />
		<!-- Generate readable JUnit-style reports -->
		
		<junitreport todir="${output.loc}">
			<fileset dir="${output.loc}">
				<include name="TEST-*.xml" />
			</fileset>
			<report format="frames" todir="${output.loc}/html" />
		</junitreport>
		
		<!-- <delete>
			<fileset dir="${testswfs.loc}" includes="TestRunner.*"/>
		</delete> -->
		
	</target>
	
</project>